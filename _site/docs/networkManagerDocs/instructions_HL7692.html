<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>HL7692 - Pilot</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>HL7692 | Pilot</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="HL7692" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="PiloT Raspberry Pi Cellular HAT" /> <meta property="og:description" content="PiloT Raspberry Pi Cellular HAT" /> <link rel="canonical" href="http://localhost:4000/docs/networkManagerDocs/instructions_HL7692.html" /> <meta property="og:url" content="http://localhost:4000/docs/networkManagerDocs/instructions_HL7692.html" /> <meta property="og:site_name" content="Pilot" /> <script type="application/ld+json"> {"@type":"WebPage","url":"http://localhost:4000/docs/networkManagerDocs/instructions_HL7692.html","headline":"HL7692","description":"PiloT Raspberry Pi Cellular HAT","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight"> Pilot </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/docs/networkManagerDocs/capture_HL8548networkManager.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/networkManagerDocs/exampleNetworkManagerConfigFile.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/networkManagerDocs/example_nmcli_configRead_O2_HL7692.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/uPilot_m.2/RPi4_USB_EM7455.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/uPilot_m.2/" class="navigation-list-link"></a></li><li class="navigation-list-item active"><a href="http://localhost:4000/" class="navigation-list-link">Pilot</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="http://localhost:4000/docs/networkManagerDocs/instructions_modemConfiguration.html" class="navigation-list-link">Pilot Configuration</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/docs/networkManagerDocs/instructions_EM7455.html" class="navigation-list-link">EM7455</a> </li><li class="navigation-list-item active"> <a href="http://localhost:4000/docs/networkManagerDocs/instructions_HL7692.html" class="navigation-list-link active">HL7692</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/docs/networkManagerDocs/instructions_HL8548.html" class="navigation-list-link">HL8548</a> </li></ul></li><li class="navigation-list-item "><a href="http://localhost:4000/scripts_python_checkIp/README.html" class="navigation-list-link">Automation - IP link check</a></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/git.html" class="navigation-list-link">Pilot GIT repo</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/networkManagerDocs/networkManagerIndex.html" class="navigation-list-link">Network Manager</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/Quickstart.html" class="navigation-list-link">Quickstart Guide</a><ul class="navigation-list-child-list"></ul></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/simUse_info.html" class="navigation-list-link">SIM Practical Testing</a></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/instructions_networkManager.html" class="navigation-list-link">Further notes 1</a></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/instructions_NetworkManagerMore.html" class="navigation-list-link">Further notes 2</a></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/speedtests/README.html" class="navigation-list-link">Speed test results</a></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/test_configurationRecords.html" class="navigation-list-link">Pilot Module Test Records</a></li><li class="navigation-list-item "><a href="http://localhost:4000/docs/networkManagerDocs/exampleNmcliConnectShow.html" class="navigation-list-link">Shell example - read connection settings</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Pilot" aria-label="Search Pilot" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/">Pilot</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/networkManagerDocs/instructions_modemConfiguration.html">Pilot Configuration</a></li> <li class="breadcrumb-nav-list-item"><span>HL7692</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h2 id="hl7692-pilot"> <a href="#hl7692-pilot" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> HL7692 Pilot </h2> <p>The aim is to configure the Raspberry Pi Raspian OS and the HL7692 to use the USB MBIM protocol to enable cellular communications between the Raspberry PI and the HL7692</p> <h2 id="hl7692-module-at-command-configuration"> <a href="#hl7692-module-at-command-configuration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> HL7692 module AT command configuration </h2> <p>With network manager and associated helpers disabled it is possible to manually command / configure the HL7692 via it’s USB serial port</p> <p>With network manager manger running it’s better to use the physical UART connection between the RPi and the Pilot / HL7692. This works ok on the RPi’s that don’t have WiFi or the RPi4.</p> <p>To access the HL7692 USB serial port command interface use a serial terminal tool like minicom</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo minicom -D /dev/ttyACM0
</code></pre></div></div> <p>To access the physical serial port use something like this (look on line on how to enable the physical serial port) - this was used on the RPi4</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo minicom -b 115200  -D /dev/ttyS0
</code></pre></div></div> <h3 id="leds"> <a href="#leds" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> LEDs </h3> <p>Note that the LED port configuration is erased if the modem firmware is updated</p> <p>The Pilot board recommended settings are as follows - the modem should be preconfigured like this when the Pilot board is new</p> <h4 id="led-d6"> <a href="#led-d6" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> LED D6 </h4> <p>Set LED D6 as cellular network status indicator with the following command</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>at+ksync=2,7
</code></pre></div></div> <p>With this setting the LED D6 behaviour is as follows</p> <ol> <li>LED PERMANENTLY OFF: Not registered / Initialization / Registration denied / no SIM card</li> <li>LED 600 ms ON / 600ms OFF: Not registered but searching</li> <li>LED 75 ms ON / 3s OFF: connected to the network</li> </ol> <h4 id="led-d5"> <a href="#led-d5" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> LED D5 </h4> <p>Set LED D5 as the cellular Pilot module boot and power indicator</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>at+kgpio=8,1
</code></pre></div></div> <p>With this setting the LED D5 behaviour is as follows</p> <ol> <li>If the modem is off then the LED will be OFF</li> <li>Following modem powered off - if a power on signal is applied to the Pilot module the LED should momentarily flash on</li> <li>Then the LED will be OFF</li> <li>After the modem has booted the LED should be ON</li> </ol> <h3 id="hl7692-usb-port-composition"> <a href="#hl7692-usb-port-composition" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> HL7692 USB port composition </h3> <p>Currently network manager manages the HL7692 network interface via MBIM if the HL7692 is reconfigured to USB composition 2 which gives 1 MBIM and 1 USB port. This a change from the modules default setting</p> <p>Note that at the time of writing (August 2019) the Sierra AT command guide indicated that three USB serial ports will be made available. But this wasn’t the case with FW RHL769x.2.26 and RHL769x.2.27 one MBIM and one serial AT port is available</p> <p>Configure the composition to enable and MBIM interface</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AT+KUSBCOMP=2
</code></pre></div></div> <p>Check the composition</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AT+KUSBCOMP?
+KUSBCOMP: 2
</code></pre></div></div> <h2 id="hl7692-and-power-on-signal"> <a href="#hl7692-and-power-on-signal" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> HL7692 and power on signal </h2> <p>We recommend using the power ON / OFF scripts to ensure correct state of modem operation</p> <ul> <li>this will override the RPi’s GPIO default state which may not be a stable signal state</li> </ul> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">RPi</th> <th style="text-align: left">HL7692 power up state</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">RPi3B+</td> <td style="text-align: left">Default GPIO state causes Pilot to power up</td> </tr> <tr> <td style="text-align: left">RPi4</td> <td style="text-align: left">Default GPIO state causes Pilot to be powered down</td> </tr> </tbody> </table></div> <h2 id="debugging-notes"> <a href="#debugging-notes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Debugging notes </h2> <p>Using the physical serial port between the Pi and Pilot can be useful during debug as the single USB serial port is managed by networkManager. If only the USB serial port is available stopping networkManager may be useful</p> <p>Check radio access technology</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AT+KSRAT?
9 == LTE first then GSM
5 == LTE Only
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AT+CGDCONT= 1,"IPV4V6","payandgo.o2.co.uk",,,  

</code></pre></div></div> <h2 id="windows"> <a href="#windows" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Windows </h2> <p>I also tested the HL7692 Pilot on a Windows 10 machine</p> <p>On the windows machine to get the HL7692 to work I had to</p> <ul> <li>Lock the modem to LTE - AT+KSRAT=5</li> <li>Manually set the apn, username and password using the windows cellular GUI</li> <li>Manually configure the modems context 1 by using AT command AT+CGDCONT = 1,”IP”,”payandgo.o2.co.uk”,,,</li> </ul> <h2 id="debugging-aids"> <a href="#debugging-aids" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Debugging aids </h2> <p>Using</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmcli monitor
</code></pre></div></div> <p>Successful connection OP capture</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>O2 Pay and Go (Prepaid): connection profile changed
cdc-wdm0: using connection 'O2 Pay and Go (Prepaid)'
cdc-wdm0: connecting (prepare)
Networkmanager is now in the 'connecting' state
cdc-wdm0: connecting (need authentication)
cdc-wdm0: connecting (prepare)
cdc-wdm0: connecting (configuring)
cdc-wdm0: connecting (getting IP configuration)
cdc-wdm0: connecting (checking IP connectivity)
cdc-wdm0: connecting (starting secondary connections)
cdc-wdm0: connected
Networkmanager is now in the 'connected (local only)' state
Networkmanager is now in the 'connected (site only)' state
'O2 Pay and Go (Prepaid)' is now the primary connection
Networkmanager is now in the 'connected' state
Connectivity is now 'full'
</code></pre></div></div> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Update this footer in _config.yml</p> </footer> </div> </div> </div> </div> </body> </html>
